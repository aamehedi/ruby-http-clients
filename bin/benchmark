#!/usr/bin/env ruby

require "bundler/setup"
require 'byebug'

$: << File.expand_path(File.join(__FILE__, "..", "..", "lib"))

require "http-clients"
require 'optparse'

options = { number: 10 }

parser = OptionParser.new do |opts|
  opts.banner = "Usage: bin/benchmark [options] URL"

  opts.on("-n N", "--number N", Integer, "Run N requests") do |number|
    options[:number] = number
  end
end

parser.parse!

endpoint = parser.default_argv.first

HTTPClients::Benchmark.new(endpoint, number: options[:number]).run
